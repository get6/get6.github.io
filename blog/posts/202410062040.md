---
title: Flutterë¡œ Feature-First ì•„í‚¤í…ì²˜ ì˜ˆì œ ì†Œê°œ
date: 2024-10-06 20:40
tags:
  - flutter
  - architecture
---

![black and green hamming bird](https://images.unsplash.com/photo-1495819903255-00fdfa38a8de?q=80&w=2527&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D)

## Feature-First ì•„í‚¤í…ì²˜
ì´ì „ì—ë„ ê°œë°œ ë°©ë²•ë¡ ê³¼ ê´€ë ¨ëœ ê¸€([Flutterì— Riverpodìš© ì•„í‚¤í…ì²˜ ë¼ì–¹ê¸°](./202406011520))ì„ ì‘ì„±í–ˆì§€ë§Œ, ì˜ˆì œì— ëŒ€í•´ì„œ ìì„¸íˆ ë§Œë“¤ì–´ë³´ì§€ ì•Šì•˜ì–´ìš”. Feature-First ì•„í‚¤í…ì²˜ë¥¼ ì–´ë–¤ ìˆœì„œë¡œ ë§Œë“¤ê³  Riverpodì„ í†µí•´ ì–´ë–»ê²Œ ë§Œë“œëŠ”ì§€ ì´ë²ˆì— ì •ë¦¬í•˜ê³  ì €ë„ ê¸°ì–µì´ ì•ˆ ë‚  ë•Œë§ˆë‹¤ ë‹¤ì‹œ ë³´ê¸° ìœ„í•´ ì‘ì„±í•´ ë³´ë ¤ê³  í•´ìš”! ğŸ¥²

**Feature-First ì•„í‚¤í…ì²˜**ëŠ” ì†Œí”„íŠ¸ì›¨ì–´ ì‹œìŠ¤í…œì„ ì„¤ê³„í•˜ê³  ê°œë°œí•  ë•Œ **Featureë¥¼ ì¤‘ì‹¬**ìœ¼ë¡œ ìƒê°í•˜ëŠ” ì ‘ê·¼ ë°©ì‹ì´ì—ìš”. ì¦‰, **ì‚¬ìš©ìì—ê²Œ ì œê³µí•  ê¸°ëŠ¥ì„ ë¨¼ì € ì •ì˜í•˜ê³ , ì´ë¥¼ êµ¬í˜„í•˜ê¸° ìœ„í•œ ê¸°ìˆ ì ì¸ ë¶€ë¶„ì„ ë‚˜ì¤‘ì— ê³ ë ¤í•˜ëŠ” ë°©ì‹**ì´ì£ . ì–´ë–¤ ì±…ì—ì„œë„ ë‚˜ì˜¤ëŠ” ë‚´ìš©ì´ì§€ë§Œ, í”„ë¡œì íŠ¸ í™œë™ì—ëŠ” ê³„íš -> ë¶„ì„ -> ì„¤ê³„ -> ì½”ë”© -> í…ŒìŠ¤íŠ¸ ìˆœì„œë¡œ ì§„í–‰ë¼ìš”. ê°œë°œ ì•„í‚¤í…ì²˜ëŠ” í•œ ê°€ì§€ ë°©ì‹ì´ ì •ë‹µì´ ì•„ë‹ˆì—ìš”. íŒ€ë§ˆë‹¤ ë‹¤ë¥´ê³  ì‚¬ëŒë§ˆë‹¤ ì„ í˜¸í•˜ëŠ” ë°©ì‹ì´ ë‹¤ë¥¼ê±°ì˜ˆìš”. ì €ë„ ì´ ì•„í‚¤í…ì²˜ë¥¼ ì‚¬ìš©í•˜ë ¤ê³  í•˜ì§€ë§Œ ì‚¬ìš©í•˜ë©´ì„œ ë°”ë€Œê±°ë‚˜ ë‹¤ë¥¸ ë°©ì‹ì„ ì ìš©í•˜ê²Œ ë  ìˆ˜ë„ ìˆì–´ìš”.

ì‹¤ì œë¡œ ì ìš©í•´ ë³´ë©´ì„œ ëŠë‚€ ì ì€ ë°±ì—”ë“œì˜ MVC íŒ¨í„´ê³¼ êµ‰ì¥íˆ ìœ ì‚¬í•˜ì§€ë§Œ, presentation ê³„ì¸µì˜ controllerìª½ì´ ì¡°ê¸ˆ ë‹¬ëì–´ìš”.
### ìš©ì–´ ì •ë¦¬
ì•„í‚¤í…ì²˜ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë§Œë“¤ê¸° ì „ì— ì•Œì•„ì•¼ í•  ê²ƒë“¤ì€ ë¨¼ì € ì •ë¦¬í•˜ê³  ì˜ˆì œë¥¼ ë§Œë“¤ ê±°ì˜ˆìš”.

ìš°ì„  Featureì™€ Domainì— ëŒ€í•´ ì´í•´í•˜ê³  ê°ˆê²Œìš”.
- **Feature:** ì‚¬ìš©ìì—ê²Œ ì œê³µë˜ëŠ” íŠ¹ì • ê¸°ëŠ¥ì´ë‚˜ ì„œë¹„ìŠ¤ë¥¼ ì˜ë¯¸í•´ìš”. ì˜ˆë¥¼ ë“¤ì–´, ì˜¨ë¼ì¸ ì‡¼í•‘ëª°ì˜ 'ì¥ë°”êµ¬ë‹ˆì— ë‹´ê¸°' ê¸°ëŠ¥, ì†Œì…œ ë¯¸ë””ì–´ì˜ 'ëŒ“ê¸€ ì‘ì„±' ê¸°ëŠ¥ ë“±ì´ ìˆì–´ìš”. FeatureëŠ” ì‚¬ìš©ì ê´€ì ì—ì„œ ë°”ë¼ë³¸ ì‹œìŠ¤í…œì˜ ê¸°ëŠ¥ì„ ë‚˜íƒ€ë‚´ìš”.
- **Domain:** ì‹œìŠ¤í…œì´ ë‹¤ë£¨ëŠ” íŠ¹ì • ì˜ì—­ ë˜ëŠ” ë¬¸ì œ ê³µê°„ì„ ì˜ë¯¸í•´ìš”. ì˜ˆë¥¼ ë“¤ì–´, ì˜¨ë¼ì¸ ì‡¼í•‘ëª°ì˜ Domainì€ 'ìƒí’ˆ', 'ì£¼ë¬¸', 'ê²°ì œ' ë“±ì´ ë  ìˆ˜ ìˆì–´ìš”. Domainì€ ì‹œìŠ¤í…œì˜ ë‚´ë¶€ì ì¸ ë…¼ë¦¬ì™€ ê·œì¹™ì„ ë‹´ë‹¹í•´ìš”.
ê°„ë‹¨íˆ ë§í•´ì„œ, FeatureëŠ” **ì‚¬ìš©ìê°€ ì§ì ‘ì ìœ¼ë¡œ ë³´ëŠ” ê¸°ëŠ¥**ì´ê³ , Domainì€ **ê·¸ ê¸°ëŠ¥ì„ êµ¬í˜„í•˜ê¸° ìœ„í•œ ë‚´ë¶€ì ì¸ ëª¨ë¸ê³¼ ê·œì¹™**ì´ì—ìš”.

ì œ í”„ë¡œì íŠ¸ í´ë” êµ¬ì¡°ì—ì„œëŠ” feature í•˜ë‚˜ë¥¼ ê¸°ë°˜ìœ¼ë¡œ í´ë”ê°€ ë§Œë“¤ì–´ì§€ê³  ê´€ë ¨ëœ í´ë”ì™€ íŒŒì¼ì„ ë§Œë“¤ì–´ìš”. í”„ë¡œì íŠ¸ì—ëŠ” `lib/src/features/feature1/domain` í´ë”ê°€ ìˆì–´ìš”. ì´ë•Œ domain í´ë”ëŠ” ìœ„ domainì˜ ì •ì˜ì™€ ë™ì¼í•˜ë©´ì„œ Modelsì´ë‚˜ Entitiesì˜ ì—­í• ì„ í•´ìš”.
### ê°œë°œ ì‹œì‘ ì „ ì •í•´ì•¼ í•  ê²ƒ
í•­ìƒ ì–´ë–¤ ê¸°ëŠ¥ì„ ë§Œë“¤ ë•ŒëŠ” ê¸°íš ë‹¨ê³„ì—ì„œ **ì´ ì„œë¹„ìŠ¤ì—ëŠ” ì–´ë–¤ ê¸°ëŠ¥ì´ ìˆë‹¤ê°€ ì •í•´ì§€ê³  ê°œë°œì´ ì‹œì‘**ë˜ì–´ì•¼ í•´ìš”. ì´ ê¸°ëŠ¥ì´ ì–´ë–¤ ì—­í• ì„ í•˜ê³  ìš”êµ¬ì‚¬í•­ì´ ì •ì˜ë˜ì–´ì•¼ í•´ìš”.

ê°œë°œìê°€ ìš”êµ¬ì‚¬í•­ì„ ì •í–ˆê±°ë‚˜ ëˆ„êµ°ê°€ ì •ë¦¬í•œ ìš”êµ¬ì‚¬í•­ì„ ê°œë°œìëŠ” ìœ ìŠ¤ì¼€ì´ìŠ¤ì™€ ì‚¬ìš©ì í”Œë¡œìš°ë¥¼ íŒŒì•…í•´ì„œ ì–´ë–¤ dataê°€ í•„ìš”í•˜ê³  ì–´ë–»ê²Œ DBì— ì €ì¥ë ì§€ ê²°ì •í•˜ë©´ ë¼ìš”. ê·¸ëŸ°ë° Flutterì—ì„œëŠ” ì¼ë°˜ì ìœ¼ë¡œ DBë¥¼ ì €ì¥í•˜ëŠ” ì—­í• ì„ ë§¡ê³  ìˆì§„ ì•Šìœ¼ë‹ˆ, ìœ íš¨ì„± ê²€ì‚¬ë¥¼ ë§ˆì¹œ dataë¥¼ APIsë¥¼ í˜¸ì¶œí•´ì„œ DBì— ì €ì¥í•  ìˆ˜ ìˆë„ë¡ ì „ë‹¬í•  ìˆ˜ ìˆëŠ” í˜•íƒœì™€ ë°ì´í„°ë¥¼ APIsë¥¼ í†µí•´ ê°€ì ¸ì˜¬ ë•Œ(fromJson í•¨ìˆ˜ í˜¸ì¶œ ì´í›„) ë°›ì•„ì£¼ëŠ” ê°ì²´ë¥¼ domainìœ¼ë¡œ ì €ëŠ” ìƒê°í•˜ê³  ìˆì–´ìš”.

ìœ ìŠ¤ì¼€ì´ìŠ¤(use case)ì™€ ì‚¬ìš©ì í”Œë¡œìš°(user flow)ë¥¼ ì¡°ê¸ˆ ë” ì‚´í´ë³¼ê²Œìš”. ì‚¬ì‹¤ ì´ ë‘ ê°€ì§€ëŠ” ê°œë°œìê°€ ì •ì˜í•´ì•¼ í•˜ëŠ” ê±´ ì•„ë‹ˆê¸´ í•´ìš”. ê°œë°œìëŠ” ì´ ìš”êµ¬ì‚¬í•­ì„ ì½”ë“œë¡œ êµ¬ì²´í™”í•˜ë©´ ë¼ìš”.
#### Use case(ì‚¬ìš© ì‚¬ë¡€)
- ì‚¬ìš©ìê°€ ì„œë¹„ìŠ¤(=ì‹œìŠ¤í…œ)ë¥¼ ì´ìš©í•´ì„œ ë‹¬ì„±í•˜ê³ ì í•˜ëŠ” ëª©í‘œë¥¼ ì‘ì—…í•  ìˆ˜ ìˆë„ë¡ ìˆ˜í–‰í•˜ê¸° ìœ„í•œ ì¼ë ¨ì˜ ì •ì˜ëœ ë™ì‘ì´ì—ìš”.

![Use case diagram - Wikipedia](https://upload.wikimedia.org/wikipedia/commons/1/1d/Use_case_restaurant_model.svg)
##### Use case ì •ì˜
- **ì£¼ì²´:** ëˆ„ê°€ ì´ ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ëŠ”ê°€? (ì‚¬ìš©ì, ê´€ë¦¬ì ë“±)
- **ëª©í‘œ:** ì‚¬ìš©ìê°€ ì´ ê¸°ëŠ¥ì„ í†µí•´ ë¬´ì—‡ì„ ë‹¬ì„±í•˜ê³ ì í•˜ëŠ”ê°€?
- **ì „ì œ ì¡°ê±´:** ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ê¸° ìœ„í•œ ì‚¬ì „ ì¡°ê±´ì€ ë¬´ì—‡ì¸ê°€?
- **ìˆ˜í–‰ ë‹¨ê³„:** ê¸°ëŠ¥ì„ ìˆ˜í–‰í•˜ê¸° ìœ„í•œ ë‹¨ê³„ëŠ” ë¬´ì—‡ì¸ê°€?
- **ê²°ê³¼:** ê¸°ëŠ¥ ìˆ˜í–‰ í›„ ì–´ë–¤ ê²°ê³¼ê°€ ë‚˜ì˜¤ëŠ”ê°€?
- **ì˜ˆì™¸:** ì˜ˆìƒë˜ëŠ” ì˜ˆì™¸ ìƒí™©ì€ ë¬´ì—‡ì¸ê°€?
#### User flow(ì‚¬ìš©ì íë¦„)
- ì‚¬ìš©ìê°€ íŠ¹ì • ëª©í‘œë¥¼ ë‹¬ì„±í•˜ê¸° ìœ„í•´ ì‹œìŠ¤í…œê³¼ ìƒí˜¸ì‘ìš©ì„ í•˜ëŠ” ê³¼ì •ì„ ë‹¨ê³„ë³„ë¡œ ì‹œê°í™”í•œ ê²ƒ
- ì¦‰, ì‚¬ìš©ìê°€ ì–´ë–¤ ìˆœì„œë¡œ ì–´ë–¤ í™”ë©´ì„ ê±°ì³ ëª©í‘œë¥¼ ë‹¬ì„±í•˜ëŠ”ì§€ë¥¼ ë³´ì—¬ì¤˜ìš”

![](assets/202408191721-20240819213907437.webp)
##### user flow ì •ì˜
- **ì‹œì‘ì :** ì‚¬ìš©ìê°€ ì–´ë””ì—ì„œ ì‹œì‘í•˜ëŠ”ê°€?
- **ë‹¨ê³„:** ì‚¬ìš©ìê°€ ì–´ë–¤ ë‹¨ê³„ë¥¼ ê±°ì³ ëª©í‘œë¥¼ ë‹¬ì„±í•˜ëŠ”ê°€? ê° ë‹¨ê³„ì—ì„œ ì‚¬ìš©ìì˜ í–‰ë™ê³¼ ì‹œìŠ¤í…œì˜ ë°˜ì‘ì„ ëª…ì‹œí•©ë‹ˆë‹¤.
- **ê²°ê³¼:** ì‚¬ìš©ìê°€ ìµœì¢…ì ìœ¼ë¡œ ì–´ë–¤ ê²°ê³¼ë¥¼ ì–»ëŠ”ê°€?
- **ë‹¤ë¥¸ ê²½ë¡œ:** ì‚¬ìš©ìê°€ ë‹¤ë¥¸ ì„ íƒì„ í•  ê²½ìš° ì–´ë–¤ ê²½ë¡œë¥¼ ê±°ì¹˜ëŠ”ê°€?
#### ì‚¬ìš© ì˜ˆì‹œ
**use case:** ì˜¨ë¼ì¸ ì‡¼í•‘ëª°ì—ì„œ ìƒí’ˆ êµ¬ë§¤í•˜ê¸°
- **ì£¼ì²´:** ì¼ë°˜ ì‚¬ìš©ì
- **ëª©í‘œ:** ì›í•˜ëŠ” ìƒí’ˆì„ êµ¬ë§¤í•˜ê³  ê²°ì œí•˜ê¸°
- **ì „ì œ ì¡°ê±´:** íšŒì› ê°€ì…, ìƒí’ˆ ê²€ìƒ‰
- **ìˆ˜í–‰ ë‹¨ê³„:** ìƒí’ˆ ìƒì„¸ í˜ì´ì§€ ë³´ê¸°, ì¥ë°”êµ¬ë‹ˆì— ë‹´ê¸°, ê²°ì œ ì •ë³´ ì…ë ¥, ì£¼ë¬¸ ì™„ë£Œ
- **ê²°ê³¼:** ì£¼ë¬¸ ì™„ë£Œ ë©”ì‹œì§€, ì£¼ë¬¸ ë‚´ì—­ í™•ì¸ ê°€ëŠ¥
- **ì˜ˆì™¸:** ì¬ê³  ë¶€ì¡±, ê²°ì œ ì‹¤íŒ¨
**user flow:**
1. ì‚¬ìš©ìê°€ ìƒí’ˆ ê²€ìƒ‰ì°½ì— í‚¤ì›Œë“œë¥¼ ì…ë ¥í•˜ê³  ê²€ìƒ‰ ë²„íŠ¼ì„ í´ë¦­
2. ê²€ìƒ‰ ê²°ê³¼ í˜ì´ì§€ì—ì„œ ì›í•˜ëŠ” ìƒí’ˆì„ ì„ íƒí•˜ê³  ìƒì„¸ í˜ì´ì§€ë¡œ ì´ë™
3. ìƒí’ˆ ìƒì„¸ í˜ì´ì§€ì—ì„œ ìƒí’ˆ ì •ë³´ë¥¼ í™•ì¸í•˜ê³  ì¥ë°”êµ¬ë‹ˆì— ë‹´ìŒ
4. ì¥ë°”êµ¬ë‹ˆ í˜ì´ì§€ì—ì„œ êµ¬ë§¤í•  ìƒí’ˆì„ í™•ì¸í•˜ê³  ê²°ì œ ë²„íŠ¼ì„ í´ë¦­
5. ê²°ì œ ì •ë³´ë¥¼ ì…ë ¥í•˜ê³  ê²°ì œë¥¼ ì™„ë£Œ
6. ì£¼ë¬¸ ì™„ë£Œ ë©”ì‹œì§€ê°€ í‘œì‹œë˜ê³ , ì£¼ë¬¸ ë‚´ì—­ í˜ì´ì§€ë¡œ ì´ë™

ì´ëŸ° ì‹ìœ¼ë¡œ ì–´ë–¤ ê¸°ëŠ¥ì— ëŒ€í•´ì„œ ì™„ë²½í•˜ì§„ ì•Šë”ë¼ë„ ì •ì˜ë¥¼ í•˜ê³  ë””ìì¸ ì´í›„ ê°œë°œí•˜ë©´ ë¼ìš”. ê·¸ëŸ°ë° Feature-First ì•„í‚¤í…ì²˜ì—ì„œë„ domain ì˜ì—­ì— entitiesì™€ usecases í´ë”ë¥¼ ê°ê° ë§Œë“œëŠ” ë°©ì‹ë„ ìˆì–´ìš”.

ê·¸ë•Œì˜ usecaseëŠ” ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ë‹´ë‹¹í•´ìš”. ìƒí’ˆ ì£¼ë¬¸, íšŒì› ê°€ì… ê°™ì€ ì‚¬ìš©ì ì‘ì—…ì— ëŒ€í•œ ê·œì¹™ê³¼ ì•Œê³ ë¦¬ì¦˜ì„ êµ¬í˜„í•´ìš”. ê·œì¹™ê³¼ ì•Œê³ ë¦¬ì¦˜ì„ êµ¬í˜„í•œë‹¤ëŠ” ëœ»ì€ ì‚¬ìš©ì ë¡œê·¸ì¸ì„ ì²˜ë¦¬í•˜ê±°ë‚˜ íŠ¹ì • ê²Œì‹œë¬¼ì„ ê°€ì ¸ì˜¤ëŠ” ë“±ì˜ ê¸°ëŠ¥ì„ êµ¬í˜„í•œë‹¤ê³  ìƒê°í•˜ë©´ë¼ìš”. ì´ëŠ” service ì˜ì—­ì—ì„œ í•˜ëŠ” ê²ƒê³¼ ë¹„ìŠ·í•œ ì¼ì´ì—ìš”.

> ì–´ë–¤ ì˜ˆì œë¥¼ ì°¾ì•„ë³´ë©´ usecasesë¼ëŠ” í´ë”ë¥¼ ë§Œë“¤ì–´ì„œ í™”ë©´ ë‚´ì—ì„œ ë‹´ë‹¹í•˜ëŠ” ì–´ë–¤ í•¨ìˆ˜ë¥¼ íŒŒì¼ í•˜ë‚˜ì”© ë§Œë“¤ë©´ì„œ ì²˜ë¦¬í•˜ëŠ”ë° ì €ëŠ” controllerë‚˜ service ìª½ì—ì„œ ì²˜ë¦¬í•˜ê¸°ë¡œ í–ˆì–´ìš”.

## ê¸°ëŠ¥ í•˜ë‚˜ë¥¼ ê°œë°œí•  ìˆœì„œ
ì´ì œ ë“œë””ì–´ ì“°ê³  ì‹¶ì—ˆë˜ ë¶€ë¶„ì´ì—ìš”. ì €ëŠ” ì•½ì† ì‹œê°„ì„ ì •í•˜ê¸° ìœ„í•´ì„œ ë‹¤ë“¤ ìê¸°ê°€ ë˜ëŠ” ì‹œê°„ì„ íˆ¬í‘œí•  ìˆ˜ ìˆë„ë¡ í•œ ëª…ì˜ ì‚¬ìš©ìê°€ ì•½ì†ì„ ìœ„í•´ ì •í•œ ì—¬ëŸ¬ ë©”íƒ€ë°ì´í„°(ì œëª©, ë‚ ì§œ, ì‹œê°„ëŒ€)ë¥¼ ê°€ì§€ëŠ” ë°ì´í„°ë¥¼ ìƒì„±í•˜ëŠ” ê¸°ëŠ¥ì„ ë§Œë“¤ë ¤ê³  í•´ìš”. ê·¸ë ‡ë‹¤ê³  í•˜ë‚˜ì˜ ê¸°ëŠ¥ìœ¼ë¡œ ë³¼ ìˆ˜ ìˆì§€ë§Œ ì•±ì—ì„œ ë³´ë©´ í•˜ë‚˜ì˜ ê¸°ëŠ¥ì´ ì•„ë‹ˆì—ìš”. ì—¬ëŸ¬ ê¸°ëŠ¥ì˜ ë¬¶ìŒìœ¼ë¡œ ë˜ì–´ ìˆì–´ìš”. ì‚¬ìš©ì íë¦„ì—ì„  ì•½ì† ì‹œê°„ ìƒì„±ì„ ëˆ„ë¥´ë©´ ì—¬ëŸ¬ í™”ë©´ì„ ì´ë™í•´ì„œ ì œëª©ì„ ì…ë ¥ë°›ê³  ë‚ ì§œë“¤ì„ ì„ íƒí•œ ë’¤, ì‹œê°„ëŒ€ë¥¼ ì„ íƒí•˜ê³  ìƒì„±ì„ ëˆ„ë¥´ëŠ” ê²ƒ, íˆ¬í‘œë¥¼ ìœ„í•œ URLì„ ê³µìœ í•˜ëŠ” ê²ƒ, ì•½ì† ì‹œê°„ì„ íˆ¬í‘œí•˜ëŠ” ê²ƒ, íˆ¬í‘œ ê²°ê³¼ë¥¼ ë³´ëŠ” ê²ƒê¹Œì§€ ì—¬ëŸ¬ ê¸°ëŠ¥ì´ ìˆì–´ìš”.

> Feature-First ì•„í‚¤í…ì²˜ì—ì„œ ê¸°ëŠ¥ì€ ì‚¬ìš©ìê°€ ì„œë¹„ìŠ¤ë¥¼ ì´ìš©í•´ ë‹¬ì„±í•˜ê³ ì í•˜ëŠ” ì™„ê²°ëœ ëª©í‘œë¥¼ ì˜ë¯¸í•´ìš”.
> ê°œë°œìê°€ ì¼ë°˜ì ìœ¼ë¡œ ìƒê°í•˜ëŠ” ê¸°ëŠ¥(ì´ë²¤íŠ¸, í•¨ìˆ˜)ê³¼ëŠ” ë‹¬ë¼ìš”.

ì–´ë–¤ featureë¥¼ ê°œë°œí•˜ê¸° ìœ„í•´ì„  ì–´ë–»ê²Œ ì‹œì‘í•´ì•¼ í• ê¹Œìš”? í”„ë¡ íŠ¸ì—”ë“œ ì…ì¥ì—ì„œ ë¬´ì–¼ ë¨¼ì € ë§Œë“œëŠ” ê²ƒì´ ì¢‹ì€ì§€ í•­ìƒ ê³ ë¯¼ì´ì—ˆì–´ìš”. ì‚¬ì‹¤ í”„ë¡ íŠ¸ì—”ë“œ ì…ì¥ì—ì„œ í™”ë©´ì´ ë‚˜ì™€ ìˆë‹¤ë©´ í™”ë©´ì„ ë¨¼ì € ë§Œë“¤ì–´ë³´ëŠ” ê²ƒë„ ì¢‹ì€ë° ê³¼ì—° ì´ê²Œ ì¢‹ì€ ë°©ë²•ì¼ê¹Œ í•˜ëŠ” ì˜ë¬¸ì´ ìˆì—ˆì–´ìš”.

ì‚¬ì‹¤ ì´ ë¶€ë¶„ì— ëŒ€í•´ì„œëŠ” ì •ë‹µì€ ì—†ì–´ìš”. ê·¸ë ‡ì§€ë§Œ ìš°ì•„í•œ í˜•ì œë“¤ì˜ ì „ CTOì´ì…¨ë˜ [ê¹€ì˜í•œë‹˜ì˜ ë‹µë³€](https://www.inflearn.com/community/questions/39853/%EC%84%A4%EA%B3%84-%EC%88%9C%EC%84%9C%EA%B0%80-%EA%B6%81%EA%B8%88%ED%95%A9%EB%8B%88%EB%8B%A4)ë„ ê³ ë¯¼ì˜ ë‹µì´ ë˜ëŠ”ë° ë„ì›€ì´ ë  ê²ƒ ê°™ì•„ìš”.

>ì´ ë¶€ë¶„ì€ ì‚¬ì‹¤ ì •í™•í•œ ì •ë‹µì€ ì—†ìŠµë‹ˆë‹¤.
>ì–´ë–¤ ê²½ìš°ì—ëŠ” í™”ë©´ë¶€í„° ì§œê³  ë“¤ì–´ê°€ëŠ” ê²Œ ë” ì¢‹ê³ , ì–´ë–¤ ê²½ìš°ì—ëŠ” ë°±ë‹¨ì˜ ë¡œì§ì„ ë¨¼ì € ì‘ì„±í•˜ëŠ” ê²Œ ë” ì¢‹ì€ ê²½ìš°ë„ ìˆìŠµë‹ˆë‹¤. íŠ¹íˆ ì›¹ í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œìì™€ ì„œë²„ ê°œë°œìê°€ ì™„ì „íˆ ë¶„ë¦¬ëœ ê²½ìš°ë¥¼ ìƒê°í•´ ë³´ë©´ ê°ê° ë™ì‹œì— ì—…ë¬´ë¥¼ ì§„í–‰í•˜ê³ , ë¶™ì—¬ì•¼ í•©ë‹ˆë‹¤. ì´ëŸ° ê²½ìš°ë¥¼ ìƒê°í•´ ë³´ë©´ í™”ë©´ê³¼ ë°±ë‹¨ì˜ ë¡œì§ì´ ë™ì‹œì— ê°œë°œ ì§„í–‰ë  ìˆ˜ ìˆì–´ì•¼ í•©ë‹ˆë‹¤.
>ê·¸ë˜ì„œ ì¤‘ìš”í•œ ê²ƒì´ ì‚¬ì‹¤ ìš”êµ¬ì‚¬í•­ ë¶„ì„ê³¼ ì„¤ê³„ì…ë‹ˆë‹¤. ì œëŒ€ë¡œ ìš”êµ¬ì‚¬í•­ì„ ë¶„ì„í•˜ê³ , ì„¤ê³„í•´ ë‘ê³ , ê¸°ëŠ¥ë³„ë¡œ ì–´ë–»ê²Œ ë™ì‘í•´ì•¼ í•˜ê³ , ì–´ë–¤ ë°ì´í„°ê°€ íë¥´ëŠ”ì§€ ìŠ¤í™ì„ ëª…í™•í•˜ê²Œ í•´ ë‘ë©´ ì–´ëŠ ìª½ìœ¼ë¡œë“  ì§„í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
>ì €ëŠ” í•µì‹¬ ë¹„ì¦ˆë‹ˆìŠ¤ ê¸°ëŠ¥ì€ ë°±ë‹¨ë¶€í„° ì‘ì—…í•˜ëŠ” ê²ƒì„ ì„ í˜¸í•©ë‹ˆë‹¤.
>ê°ì‚¬í•©ë‹ˆë‹¤^^

ì €ë„ ë¹„ì¦ˆë‹ˆìŠ¤ ê¸°ëŠ¥ë¶€í„° ë§Œë“¤ì–´ ë³´ë ¤ê³  í•´ìš”. ê·¸ë¦¬ê³  UIë¶€í„° ë§Œë“¤ê²Œ ë˜ë©´ ì´ëŸ¬í•œ ì‹œë‚˜ë¦¬ì˜¤ê°€ ì˜ˆìƒë¼ìš”.
1. UI í™”ë©´ì„ ë‹¤ ë§Œë“¤ê³  ë²„íŠ¼ ì´ë²¤íŠ¸ë‚˜ ë°ì´í„° ëª©ë¡ì„ ê°€ì ¸ì˜¤ê³  í™”ë©´ì„ í‘œì‹œí•´ì•¼ í•  ê²½ìš°ê°€ ìƒê¹€ <- ë‚˜ì¤‘ì— APIë‚˜ ìƒíƒœ ê´€ë¦¬ ì¶”ê°€í•˜ê³  ë‹¤ì‹œ í™•ì¸í•´ì•¼ í•¨
2. UI í™”ë©´ì„ ë‹¤ ë§Œë“  ë’¤, ìˆœì„œë¥¼ controllerë‚˜ serviceë¥¼ ë§Œë“¤ê²Œ ë˜ë©´ ê²°êµ­ repositoryë‚˜ modelì„ ì£¼ì…í•˜ê±°ë‚˜ ì°¸ì¡°í•´ì•¼ í•˜ëŠ” ê²½ìš°ê°€ ìƒê²¨ì„œ controllerë¥¼ í…ŒìŠ¤íŠ¸í•˜ê¸° ìœ„í•´ì„  ë‚˜ë¨¸ì§€ê°€ ì„ í–‰ë˜ì–´ì•¼ í•¨

ì´ê±´ ì–µì§€ë¡œ ìƒê°í•´ ë³¸ ì‚¬ë¡€ì´ê¸° ë•Œë¬¸ì— ê¼­ ì´ëŸ° ë¬¸ì œê°€ ìƒê¸°ëŠ” ê±´ ì•„ë‹ˆì§€ë§Œ, UIê°€ ì–´ë–¤ ê°ì²´ë¥¼ ì˜ì¡´í•  ë•Œ, ê·¸ê²Œ í•´ê²°ë˜ê¸° ì „ê¹Œì§€ ê°œë°œí•˜ëŠ” ê³¼ì •ì—ì„œ ì˜¤ë¥˜ê°€ ë–  ìˆëŠ” ìƒíƒœê°€ ì˜¤ë˜ ì§€ì†ë  ìˆ˜ ìˆì„ ê²ƒ ê°™ì•„ìš”. ë˜í•œ ë‹¤ë¥¸ ê³„ì¸µì„ ë§Œë“¤ ë•Œ UIë¥¼ ê³ ë ¤í•˜ê²Œ ëœë‹¤ë©´ UIìª½ ì½”ë“œë¥¼ ë³€ê²½í•˜ê¸° ì‹«ì–´ì„œ ì˜ì¡´ì„±ì„ ê°•í•˜ê²Œ ë§Œë“¤ ìˆ˜ ìˆì§€ ì•Šì„ê¹Œ ì‹¶ì–´ìš”.

ì €ëŠ” ê¸°ëŠ¥ ìš”êµ¬ì‚¬í•­ì´ ìˆìœ¼ë‹ˆ, domainë¶€í„° ë§Œë“¤ê²Œìš”. ì´ë²ˆì— ë§Œë“¤ ì‚¬ë¡€ë¡œ ì¹œêµ¬ë“¤ê³¼ ì•½ì† ì‹œê°„ì„ ì •í•˜ê¸° ìœ„í•œ ì‹œê°„ì„ íˆ¬í‘œí•˜ëŠ” ê¸°ëŠ¥ì„ ì˜ˆë¡œ ë“¤ ê±°ì˜ˆìš”.

ëŒ€ë¶€ë¶„ì˜ Riverpodì„ ì‚¬ìš©í•˜ì§€ë§Œ, controller ì˜ì—­ì„ ì œì™¸í•˜ê³ ëŠ” ëŒ€ë¶€ë¶„ í™”ë©´ì—ì„œ ì§ì ‘ ìƒì„±ì„ í”¼í•˜ê³  ì•Œì•„ì„œ ì£¼ì…ë  ìˆ˜ ìˆëŠ” ì‹±ê¸€í†¤ìœ¼ë¡œ ì‚¬ìš©í•  ê±°ì˜ˆìš”.

> ì½”ë“œì—ì„œ importëŠ” ì§€ì› ìœ¼ë‹ˆ ê·¸ëŒ€ë¡œ ë”°ë¼ í•˜ì‹œë©´ ì—ëŸ¬ê°€ ë‚˜ì‹¤ ê±°ì˜ˆìš”. VS Codeì—ì„œ ì˜¤ë¥˜ ë©”ì‹œì§€ë¥¼ ì˜ ì‚´í´ë³´ì„¸ìš”!

### Domain ê³„ì¸µ êµ¬í˜„
Entitiesì— í•´ë‹¹í•˜ëŠ” ì£¼ìš” ì—”í‹°í‹°(=ëª¨ë¸)ë¥¼ ì •ì˜í•´ìš”. ì €ëŠ” ì‹œê°„ íˆ¬í‘œë¥¼ ìœ„í•œ ê±°ë‹ˆê¹ votingì´ë¼ëŠ” ê¸°ëŠ¥ì˜ ì´ë¦„ì„ ìƒê°í–ˆë‹¤ê°€ ì¼ì •ê³¼ ê´€ë ¨ëœ ì„œë¹„ìŠ¤ë¼ê³  ìƒê°í•´ì„œ `lib/src/features/calendar` í´ë”ë¥¼ ë§Œë“¤ì—ˆì–´ìš”. ê¸°ëŠ¥ì„ ì˜ëª» ë§Œë“¤ê±°ë‚˜ ì˜ëª»ëœ ìœ„ì¹˜ì— ê¸°ëŠ¥ì„ ë§Œë“¤ì–´ë„ ë‚˜ì¤‘ì— íŒŒì¼ëª…ë§Œ ë°”ê¾¸ë©´ ë˜ë‹ˆê¹ ì¼ë‹¨ì€ í¬ê²Œ ì‹ ê²½ ì“°ì§€ ì•Šë„ë¡ í–ˆì–´ìš”. ì—”í‹°í‹° ì´ë¦„ì€ [When2meet](https://www.when2meet.com/)ì´ë¼ëŠ” ì„œë¹„ìŠ¤ê°€ ìˆì–´ì„œ features/calendar/domain/when_to_meet.dart íŒŒì¼ì„ ë§Œë“¤ ê±°ì˜ˆìš”.

> ì½”ë“œë¥¼ ë³´ë©´ ì €ëŠ” code generatorë¥¼ ì‚¬ìš©í•˜ê³  ìˆì–´ì„œ part ë¶€ë¶„ì´ ì¶”ê°€ë˜ì–´ ìˆì–´ìš”.
> `flutter pub run build_runner watch`ë¥¼ ì…ë ¥í•˜ê³  ê°œë°œí•´ ì£¼ì„¸ìš”.
> ì €ëŠ” í¸í•˜ê²Œ ì“°ê¸° ìœ„í•´ì„œ VS Codeì—ì„œ Build Runner í™•ì¥ì„ ì‚¬ìš©í•˜ê³  ìˆì–´ìš”.

```dart
part 'when_to_meet.freezed.dart';
part 'when_to_meet.g.dart';

typedef WhenToMeetID = String;

/// WhenToMeetì€ ì•½ì† ì‹œê°„ì„ ì •í•˜ê¸° ìœ„í•´ ì‚¬ìš©ë˜ëŠ” í´ë˜ìŠ¤ì…ë‹ˆë‹¤.
@freezed
class WhenToMeet with _$WhenToMeet {
  const factory WhenToMeet({
    required WhenToMeetID id,
    required String title,
    required UserID creator,
    required List<User> invitees,
    required List<AnonymousUser> attendees,
    required Map<DateTime, Set<TimeSlot>> availableTimes,
    required Map<UserID, Map<DateTime, Set<TimeSlot>>> selectedTimes,
  }) = _WhenToMeet;

  factory WhenToMeet.fromJson(Map<String, dynamic> json) => _WhenToMeet.fromJson(json);

  factory WhenToMeet.empty() => WhenToMeet(
        id: const UuidV4().generate(),
        title: '',
        creator: '',
        invitees: [],
        attendees: [],
        availableTimes: {},
        selectedTimes: {},
      );

  factory WhenToMeet.fromCreationState(String title, Map<DateTime, Set<TimeSlot>> availableTimes) => WhenToMeet(
        id: const UuidV4().generate(),
        title: title,
        creator: '',
        invitees: [],
        attendees: [],
        availableTimes: availableTimes,
        selectedTimes: {},
      );
}
```

ìŠ¤íƒœí‹± í•¨ìˆ˜ë¡œ emptyëŠ” í…ŒìŠ¤íŠ¸ìš©ìœ¼ë¡œ ë§Œë“¤ì—ˆê³  fromCreationState í•¨ìˆ˜ëŠ” ì´ë”° Presentation ê³„ì¸µì—ì„œ WhenToMeetCreationControllerì—ì„œ WhenToMeetCreationStateë¥¼ ìœ„í•œ ì´ˆê¸°í™” í•¨ìˆ˜ì˜ˆìš”.
### Data ê³„ì¸µ êµ¬í˜„
ë°ì´í„° ê³„ì¸µì—ì„œëŠ” ë¡œì»¬ or ì›ê²©ìœ¼ë¡œë¶€í„° ë°ì´í„° CRUDë¥¼ ì²˜ë¦¬í•´ìš”. íŠ¹ì • Entityë§ˆë‹¤ CRUD ì¤‘ êµ¬í˜„í•´ì•¼ í•˜ëŠ” ê²ƒì´ ë‹¤ë¥¼ ìˆ˜ ìˆì§€ë§Œ ì´ë²ˆì—ëŠ” CRUD ëª¨ë‘ë¥¼ ì¶”ìƒí™”í•  ê±°ì˜ˆìš”. ì´ ë¶€ë¶„ ì—­ì‹œ VS Code ìŠ¤ë‹ˆí«ì„ ì´ìš©í•œë‹¤ë©´ í¸ë¦¬í•  ê±°ì˜ˆìš”.

```dart
// features/calendar/data/when_to_meet_repository.dart íŒŒì¼ë¡œ ìƒì„±í•˜ê¸°
abstract class WhenToMeetRepository {
  Future<List<WhenToMeet>> getWhenToMeets();
  Future<void> addWhenToMeet(WhenToMeet whenToMeet);
  Future<void> deleteWhenToMeet(WhenToMeet whenToMeet);
  Future<void> updateWhenToMeet(WhenToMeet whenToMeet);
}
```

ì´ì œ êµ¬í˜„ì²´ë¥¼ ë§Œë“¤ì–´ì¤„ê±°ì˜ˆìš”. ì €ëŠ” firestoreë¥¼ ì´ìš©í•˜ê³  ìˆê¸° ë•Œë¬¸ì— ì•„ë˜ì™€ ë¹„ìŠ·í•œ ì´ë¦„ìœ¼ë¡œ ë§Œë“¤ì–´ì£¼ë©´ ë¼ìš”.
- remote_when_to_meet_repository.dart
- firesbase_when_to_meet_repository.dart

Repository ë‚´ë¶€ì— FirebaseFiresotreë¥¼ í†µí•´ ë°ì´í„°ë¥¼ ì™¸ë¶€ì—ì„œ ì¡°ì‘í•´ìš”. ê·¸ë˜ì„œ ì´ê±¸ ì™¸ë¶€ì—ì„œ ì£¼ì…í•´ì¤„ê±°ì˜ˆìš”. RemoteWhenToMeetRepositoryì„ ì‚¬ìš©í•˜ëŠ” ìª½ì—ì„œ ì§ì ‘ ìƒì„±í•˜ì§€ ì•Šê³  providerë¥¼ í†µí•´ ë„˜ê²¨ë°›ì„ê±°ì˜ˆìš”. ì´ëŸ°ì‹ìœ¼ë¡œ Riverpodì„ í†µí•´ í•„ìš”í•œ ê³„ì¸µì„ ë‹´ë‹¹í•˜ëŠ” ê°ì²´ë¥¼ ë„˜ê²¨ë°›ê³  ë„˜ê²¨ì¤„ê±°ì˜ˆìš”.

```dart
part 'remote_when_to_meet_repository.g.dart';

class RemoteWhenToMeetRepository implements WhenToMeetRepository {
  const RemoteWhenToMeetRepository(this._fs);
  final FirebaseFirestore _fs;

  CollectionReference get _whenToMeetCollection => _fs.collection('when_to_meet');

  @override
  Future<void> addWhenToMeet(WhenToMeet whenToMeet) {
    return _whenToMeetCollection.doc(whenToMeet.id).set(whenToMeet.toJson());
  }

  @override
  Future<void> deleteWhenToMeet(WhenToMeet whenToMeet) {
    return _whenToMeetCollection.doc(whenToMeet.id).delete();
  }

  @override
  Future<List<WhenToMeet>> getWhenToMeets() {
    return _whenToMeetCollection.get().then((snapshot) {
      return snapshot.docs.map((doc) {
        return WhenToMeet.fromJson(doc.data() as Map<String, dynamic>);
      }).toList();
    });
  }

  @override
  Future<void> updateWhenToMeet(WhenToMeet whenToMeet) {
    return _whenToMeetCollection.doc(whenToMeet.id).update(whenToMeet.toJson());
  }
}

@riverpod
WhenToMeetRepository whenToMeetRepository(WhenToMeetRepositoryRef ref) {
  return RemoteWhenToMeetRepository(fs: ref.watch(firebaseFirestoreProvider));
}
```

> ì •ë§ íŠ¹ë³„í•œ ìƒí™©ì´ ì•„ë‹ˆë¼ë©´ whenToMeetRepositoryProvider ê°™ì´ providerë¥¼ ë§Œë“œëŠ” ë¶€ë¶„ì—ì„œ ref.read ëŒ€ì‹  ref.watchë¥¼ ì‚¬ìš©í•´ ì£¼ì„¸ìš”.

í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•´ì„  FakeWhenToMeetRepositoryë¥¼ ë§Œë“¤ê³  ê° í•¨ìˆ˜ì—ì„œ ì„ì˜ì˜ ê°’ì„ ì„¤ì •í•´ì„œ ë°˜í™˜í•˜ë©´ í…ŒìŠ¤íŠ¸í•˜ê¸° í¸í•  ê±°ì˜ˆìš”.

firebaseFirestoreProviderëŠ” lib/src/common/providers/general_providers.dart íŒŒì¼ì— ë§Œë“¤ì–´ì¤¬ì–´ìš”. ê·¸ëŸ°ë° ì´ê±´ ì´ë¯¸ ì „ì—­ ë³€ìˆ˜ë¡œ ì‚¬ìš©ë˜ê¸° ë•Œë¬¸ì— ê¼­ í•„ìš”í•˜ì§„ ì•Šì•„ìš”.

```dart
part 'general_provider.g.dart';

@riverpod
FirebaseFirestore firebaseFirestore(FirebaseFirestoreRef ref) {
  return FirebaseFirestore.instance;
}
```
### Application êµ¬í˜„
ì´ì œ WhenToMeetServiceë¥¼ ë§Œë“¤ ì°¨ë¡€ê°€ ì™”ì–´ìš”. ì´ ì„œë¹„ìŠ¤ëŠ” ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ì²˜ë¦¬í•´ìš”.

```dart
part 'when_to_meet_service.g.dart';

class WhenToMeetService {
  WhenToMeetService({
    required this.remoteWhenToMeetRepository,
  });
  final RemoteWhenToMeetRepository remoteWhenToMeetRepository;

  Future<void> addWhenToMeet(WhenToMeet whenToMeet) {
    return remoteWhenToMeetRepository.addWhenToMeet(whenToMeet);
  }

  Future<List<WhenToMeet>> fetchWhenToMeets(User user) {
    return remoteWhenToMeetRepository.getWhenToMeets(user.id);
  }

  Future<WhenToMeet?> fetchWhenToMeet(WhenToMeetID id) {
    return remoteWhenToMeetRepository.getWhenToMeet(id);
  }

  Future<void> updateWhenToMeet(WhenToMeet whenToMeet) {
    return remoteWhenToMeetRepository.updateWhenToMeet(whenToMeet);
  }
}

@riverpod
WhenToMeetService whenToMeetService(WhenToMeetServiceRef ref) {
  return WhenToMeetService(
    remoteWhenToMeetRepository: ref.watch(remoteWhenToMeetRepositoryProvider),
  );
}
```

ì„œë¹„ìŠ¤ì—ëŠ” ë°ì´í„°ë¥¼ ì¶”ê°€í•˜ê³  ê°±ì‹ í•˜ê±°ë‚˜ ë‹¨ê±´ ë°ì´í„°ë¥¼ ë°›ì•„ì™€ìš”. í•¨ìˆ˜ ì´ë¦„ì„ repositoryì™€ ë¹„ìŠ·í•˜ê²Œ ë§Œë“¤ê³  ì‹¶ì€ ìš•êµ¬ë„ ë“¤ì§€ë§Œ, ìµœëŒ€í•œ ì˜ë¯¸ë¥¼ ë‹´ì•„ë„ ì¢‹ì„ ê²ƒ ê°™ì•„ìš”. ì›ë˜ë¼ë©´ ë” ë§ì€ í•¨ìˆ˜ë“¤ì´ ìˆì–´ì•¼ í•  ê±°ì˜ˆìš”. ë¡œê·¸ì¸í–ˆë˜ ì‚¬ìš©ìê°€ ìƒì„±í•˜ê±°ë‚˜ ì°¸ì—¬í–ˆë˜ ëª©ë¡ì„ ê°€ì ¸ì™€ì•¼ í•  ìˆ˜ë„ ìˆì§€ë§Œ, ì§€ê¸ˆì€ ë‹¨ìˆœí•˜ê²Œ ë§Œë“¤ê²Œìš”. ì§€ê¸ˆì€ ë”°ë¡œ ì²˜ë¦¬ë¥¼ í•˜ì§„ ì•Šì•˜ì§€ë§Œ, í•„ìš”í•˜ë‹¤ë©´ service í•¨ìˆ˜ ë‚´ì—ì„œ ì–´ë–¤ ì²˜ë¦¬ë¥¼ í•  ìˆ˜ë„ ìˆì„ ê±°ì˜ˆìš”.
### Presentation êµ¬í˜„
ì´ì œ Screenê³¼ Controllerë¥¼ ë§Œë“¤ ê±°ì˜ˆìš”. ì €ëŠ” Screenê³¼ ControllerëŠ” í”Œë«í¼ë§ˆë‹¤ ë‹¤ë¥´ê²Œ ë§Œë“¤ì–´ì•¼ í•  ìˆ˜ë„ ìˆë‹¤ê³  ìƒê°í•´ìš”. ëª¨ë°”ì¼, íƒœë¸”ë¦¿, ë°ìŠ¤í¬íƒ‘ ìŠ¤í¬ë¦°ì— ë”°ë¼ í‘œí˜„í•´ì•¼ í•  UIê°€ ë‹¬ë¼ì§ˆ í…ë°, UIê°€ ë‹¬ë¼ì§€ë©´ ì²˜ë¦¬í•˜ëŠ” ë°ì´í„°ëŠ” ê°™ë”ë¼ë„ í•œë²ˆì— ì²˜ë¦¬ë˜ê±°ë‚˜ í™”ë©´ ì „í™˜ì´ ë˜ë©´ì„œ ë°ì´í„°ë¥¼ í•˜ë‚˜ì”© ëª¨ìœ¼ëŠ” ê²½ìš°ë¼ë©´ Screenì˜ ê°œìˆ˜ì™€ ê·¸ Screenì—ì„œ ìƒíƒœ ê´€ë¦¬ë¥¼ í•´ì•¼ í•˜ëŠ” ê²½ìš° Controllerë„ ë‹¬ë¼ì§ˆ ê±°ë¼ê³  ìƒê°í•´ìš”.

ì´ë²ˆì—ëŠ” ëª¨ë°”ì¼ìš© í™”ë©´ë§Œ ë§Œë“¤ì–´ë³¼ê²Œìš”. ì œëª© ì…ë ¥, ë‚ ì§œ ì„ íƒ, ì‹œê°„ëŒ€ ì„ íƒì„ ìœ„í•´ ìµœì†Œ 3ê°œì˜ í™”ë©´ì´ í•„ìš”í•˜ì§€ë§Œ, ê¸€ì´ êµ‰ì¥íˆ ê¸¸ì–´ì§ˆ ê²ƒ ê°™ì•„ì„œ ê°€ì¥ ì²«ë²ˆì§¸ í™”ë©´ë§Œ ë³´ì—¬ë“œë¦´ê²Œìš”. \_pages ë³€ìˆ˜ì—ì„œ **ì œëª© ì…ë ¥**, **ë‚ ì§œ ì„ íƒ**, **ì‹œê°„ëŒ€ ì„ íƒ**ë¥¼ ì°¨ë¡€ëŒ€ë¡œ ìˆ˜í–‰í•´ìš”. ì—¬ê¸°ì„œ ì‚¬ìš©ë˜ëŠ” ë³€ìˆ˜ë“¤ë¡œë¶€í„° ë°ì´í„°ë¥¼ ë°›ëŠ” ê±´ Controllerì—ì„œ í•´ìš”.

```dart
class WhenToMeetCreationPage extends ConsumerWidget {
  const WhenToMeetCreationPage({super.key});

  final List<Widget> _pages = const [
    WhenToMeetCreationTitlePage(),
    WhenToMeetCreationDatePage(),
    WhenToMeetCreationTimePage(),
  ];

  @override
  Widget build(BuildContext context, WidgetRef ref) {
    final controller = ref.read(whenToMeetCreationControllerProvider.notifier);
    final state = ref.watch(whenToMeetCreationControllerProvider);

    return GestureDetector(
      onTap: () => FocusScope.of(context).unfocus(),
      child: Scaffold(
        appBar: AppBar(
          title: const Text('ì•½ì† ë§Œë“¤ê¸°'),
          leading: controller.isFirstStep()
              ? null
              : IconButton(
                  icon: const Icon(Icons.arrow_back),
                  onPressed: () => controller.previousStep(),
                ),
        ),
        body: SafeArea(
          child: Column(
            children: [
              Padding(
                padding: const EdgeInsets.symmetric(horizontal: pg),
                child: StepProgressIndicator(stepProgress: state.stepProgress),
              ),
              const SizedBox(height: pg * 2),
              Expanded(child: _pages[state.stepProgress.step]),
            ],
          ),
        ),
      ),
    );
  }
}
```

#### Controller ì„¤ëª…
Controllerì— ì‘ì„±ë  í•¨ìˆ˜ëŠ” ì£¼ë¡œ ìœ íš¨ì„± ê²€ì¦ì´ ëë‚œ ì…ë ¥ ë°ì´í„°ë¥¼ ë°›ê±°ë‚˜, ìœ„ì ¯ì´ ë Œë”ë§ ë˜ëŠ” ì‹œì ì— ë°ì´í„°ë¥¼ ì „ë‹¬í•˜ê±°ë‚˜, ë²„íŠ¼ ê°™ì€ ì´ë²¤íŠ¸ë¥¼ í†µí•´ ë°ì´í„°ë¥¼ ì „ë‹¬í•˜ëŠ” ê²½ìš°ê°€ ëŒ€ë¶€ë¶„ì´ì—ìš”.

Controllerê°€ ì‚¬ì‹¤ ì´ ì•„í‚¤í…ì²˜ì—ì„œ ê°€ì¥ ë‚œí•´í•˜ê³  ì–´ë–»ê²Œ í•˜ë©´ ì¢‹ì„ì§€ ê³ ë¯¼ì´ ë§ì´ ë˜ì—ˆë˜ ë¶€ë¶„ì´ì—ˆì–´ìš”. ì²˜ìŒì—ëŠ” riverpodìœ¼ë¡œ NotifireProviderë¥¼ ë§Œë“¤ ë•Œ, ê¼­ domain ê°ì²´ë¥¼ ì‚¬ìš©í•´ì•¼ í•˜ëŠ” ê²ƒ ê°™ì€ ê°•ë°•ì„ ëŠê¼ˆì–´ìš”. ê·¸ëŸ¬ë‚˜ ìˆ˜ì •í• ìˆ˜ë¡ í™”ë©´ì—ì„œ ì–»ì–´ë‚¸ ë°ì´í„°ë¥¼ ê¼­ ë¹ˆ ë„ë©”ì¸ì— í•˜ë‚˜ì”© ì±„ì›Œ ë„£ì„ í•„ìš”ê°€ ì—†ë‹¤ëŠ” ê±¸ ì•Œì•˜ì–´ìš”. domainì´ serviceë¡œ ë„˜ì–´ê°€ê¸° ì§ì „ì—ë§Œ ê°ì²´ë¡œ ë§Œë“¤ì–´ì¤˜ë„ ì¶©ë¶„í–ˆì–´ìš”. serviceì— ë„˜ê¸°ê¸° ì „ê¹Œì§€ëŠ” ìµœëŒ€í•œ ì‚¬ìš©í•˜ê¸° ì‰¬ìš´  í˜•íƒœì˜ ë°ì´í„°ë¡œ í•˜ëŠ” ê²ƒì´ ì €ë„ ë” ì¦ê²ê²Œ ê°œë°œí•  ìˆ˜ ìˆì—ˆì–´ìš”.

ê·¸ë˜ì„œ Controllerë¥¼ ìœ„í•œ í´ë˜ìŠ¤ë¥¼ ë§Œë“¤ì—ˆì–´ìš”. ê¼­ freezedë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šì•„ë„ ê´œì°®ì„ ê²ƒ ê°™ì•„ìš”.
WhenToMeetCreationState íŒŒì¼ì€ WhenToMeetCreationControllerì˜ build í•¨ìˆ˜ì˜ ë°˜í™˜ê°’ì´ì—ìš”.
ì´ í´ë˜ìŠ¤ê°€ ê°–ëŠ” ë³€ìˆ˜ë¥¼ ë³´ë©´ ì•½ì† ìƒì„± í™”ë©´ì—ì„œ ì‚¬ìš©í•˜ëŠ” ë³€ìˆ˜ë“¤ì„ ë‹´ê³  ìˆì–´ìš”. title, dates,selectedTimesì—ìš”. ì´ 3ê°œì˜ ë³€ìˆ˜ê°€ ì‚¬ìš©ì ì„ íƒì„ í•  ë•Œë§ˆë‹¤ ê°’ì´ ì±„ì›Œì ¸ìš”. WhenToMeetCreationStateëŠ” WhenToMeetCreationControllerì™€ ê°™ì€ íŒŒì¼ì—ë‹¤ ë§Œë“¤ì—ˆì–´ìš”. ë‘ê°œì˜ íŒŒì¼ë¡œ ë¶„ë¦¬í•´ë„ ì¢‹ê² ì§€ë§Œ í¸í•˜ê²Œ í•˜ê¸° ìœ„í•´ ì €ëŠ” í•˜ë‚˜ì˜ íŒŒì¼ì— ë’€ì–´ìš”.
```dart
part 'when_to_meet_creation_controller.freezed.dart';
part 'when_to_meet_creation_controller.g.dart';

@freezed
class WhenToMeetCreationState with _$WhenToMeetCreationState {
  const factory WhenToMeetCreationState({
    required String title,
    required List<DateTime> dates,
    required List<int> selectedTimes,
    required List<TimeSlot> availableTimes,
    required StepProgress stepProgress,
  }) = _WhenToMeetCreationState;

  factory WhenToMeetCreationState.empty() {
    return WhenToMeetCreationState(
      title: '',
      dates: [],
      selectedTimes: [],
      availableTimes: [],
      stepProgress: StepProgress(step: 0, initialStep: 0, totalSteps: 3),
    );
  }
}

extension WhenToMeetCreationStateX on WhenToMeetCreationState {
  WhenToMeet toDomain() {
    final availableTimesMap =
        Map<DateTime, Set<TimeSlot>>.fromEntries(dates.map((date) => MapEntry(date, Set.from(availableTimes))));
    return WhenToMeet.fromCreationState(title, availableTimesMap);
  }
}
```

> StepProgressëŠ” í™”ë©´ì„ ì´ë™í•  ë•Œ ëª‡ ë²ˆì§¸ ìˆœì„œì¸ì§€ ì•Œë ¤ì£¼ëŠ” ê°’ì¸ë° ì•„í‚¤í…ì²˜ë¥¼ ì„¤ëª…í•  ë•ŒëŠ” ë³„ë¡œ ì•ˆ ì¤‘ìš”í•œ ê²ƒ ê°™ì•„ì„œ ë„˜ì–´ê°ˆê²Œìš”.

WhenToMeetCreationControllerëŠ” í•¨ìˆ˜ê°€ ì—¬ëŸ¬ ê°œê°€ ìˆëŠ”ë°ìš”. ì œëª©ì„ ì…ë ¥ë°›ì„ ë•Œ, ë‚ ì§œë¥¼ ì„ íƒí•  ë•Œ, ì‹œê°„ëŒ€ë¥¼ ì„ íƒí•  ë•Œ í˜¸ì¶œë˜ê¸°ë„ í•˜ê³  ì…ë ¥ í•„ë“œì˜ ê°’ì´ ë°”ë€” ë•Œë§ˆë‹¤ í˜¸ì¶œë˜ëŠ” í•¨ìˆ˜ë„ ìˆì–´ìš”. ë§ˆì§€ë§‰ì— ì €ì¥í•  ë•ŒëŠ” createWhenToMeet í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•´ Firestoreì— ì €ì¥í•´ìš”.
```dart
@riverpod
class WhenToMeetCreationController extends _$WhenToMeetCreationController {
  @override
  WhenToMeetCreationState build() {
    ref.onDispose(() => print('WhenToMeetCreationController disposed'));
    print('WhenToMeetCreationController created');
    // ë°˜í™˜ê°’ì„ Domainì„ ê·¸ëŒ€ë¡œ ì“°ì§€ ì•Šê³  Stateë¥¼ ë§Œë“¤ì–´ì„œ ì“°ëŠ”ê²Œ ë” ë‚«ë‹¤. ê·¸ëŸ°ë° ì§€ê¸ˆ ë‹¤ ë§Œë“¤ì–´ë†”ì„œ ê·¸ëƒ¥ ì“°ì.
    return WhenToMeetCreationState.empty();
  }

  Future<WhenToMeet> createWhenToMeet(List<TimeSlot> slots) async {
    state = state.copyWith(availableTimes: slots);
    final service = ref.read(whenToMeetServiceProvider);
    final whenToMeet = state.toDomain();
    await service.addWhenToMeet(whenToMeet);
    return whenToMeet;
  }

  void previousStep() {
    if (state.stepProgress.isFirstStep()) {
      return;
    }
    state = state.copyWith(stepProgress: state.stepProgress.previousStep());
  }

  void nextStep() {
    if (state.stepProgress.isLastStep()) {
      return;
    }
    state = state.copyWith(stepProgress: state.stepProgress.nextStep());
  }

  // ì œëª© ì…ë ¥
  void updateTitle(String title) {
    state = state.copyWith(title: title);
    nextStep();
  }

  // ë‚ ì§œ ì…ë ¥
  void updateDates(List<DateTime> dates) {
    if (state.title.isEmpty) {
      assert(false, 'title is empty');
    }

    state = state.copyWith(dates: dates);
    nextStep();
  }

  // ì‹œê°„ëŒ€ ì…ë ¥
  void updateAvailableTimes(List<int> selectedTimes) {
    if (state.dates.isEmpty) {
      assert(false, 'Dates are empty');
    }

    state = state.copyWith(selectedTimes: selectedTimes);
  }

  void updateSelectedTimes(List<int> selectedTimes) {
    state = state.copyWith(selectedTimes: selectedTimes);
  }

  bool isFirstStep() => state.stepProgress.isFirstStep();
}
```

ì´ ì•„í‚¤í…ì²˜ë¥¼ í•˜ë©´ì„œ ê°€ì¥ ê³ ë¯¼ì„ ë§ì´ í–ˆë˜ ë¶€ë¶„ì€ Presentationì—ì„œ ë°ì´í„°ë¥¼ ê´€ë¦¬í•  ë•Œ Domainì— ì§‘ì°©í–ˆì—ˆì„ ë•Œì˜€ì–´ìš”. ë°±ì—”ë“œì—ëŠ” DAOì™€ DTOë¼ëŠ” ê°œë…ì´ ìˆì–´ìš”. ì´ê±°ì™€ ë¹„ìŠ·í•˜ê²Œ í™”ë©´ì—ì„œëŠ” í•„ìš”í•œ ë°ì´í„°ê°€ ìˆëŠ”ë° ì´ê²Œ ì €ì¥í•  ë•ŒëŠ” ê°€ê³µë˜ê±°ë‚˜ í•„ìš” ì—†ëŠ” ë°ì´í„°ì¼ ìˆ˜ ìˆì—ˆì–´ìš”. ì €ëŠ” ì´ê±¸ domain ê°ì²´ë¥¼ ì“°ë©´ì„œ ë³´ì¡°í•¨ìˆ˜ë¥¼ ë§Œë“¤ì–´ì„œ ë³µì¡í•˜ê²Œ ë§Œë“¤ì—ˆëŠ”ë° ì…ë ¥ ë°ì´í„°ë¥¼ ê·¸ëŒ€ë¡œ ì €ì¥í•˜ëŠ” WhenToMeetCreationState ê°ì²´ë¥¼ ë§Œë“œë‹ˆ ì½”ë“œê°€ ë” ê°„ê²°í•´ì¡Œì–´ìš”.

> ì•„ì§ ì™„ë²½í•˜ê²Œ ì´í•´í•´ì„œ Feature-First ì•„í‚¤í…ì²˜ + Riverpodì„ í•¨ê»˜ ì“°ê³  ìˆì§€ ëª»í•œë‹¤ê³  ìƒê°í•´ìš”.
> ê³„ì† ì‚¬ìš©í•˜ë©´ì„œ ë¹„ìŠ·í•˜ê²Œ ë§Œë“¤ì–´ ë³¸ ìë£Œë¼ê³  ìƒê°í•´ ì£¼ì„¸ìš”!

ê·¸ì € Flutter ê°œë°œì„ ì‹œì‘í•˜ì‹œëŠ” ë¶„ë“¤ì—ê²Œ ì¡°ê¸ˆì´ë‚˜ë§ˆ ê°€ì´ë“œê°€ ë˜ì—ˆê¸¸ ë°”ëë‹ˆë‹¤! ğŸ¥¹

---

> [!quote] You can stand tall without standing on someone. You can be a victor without having victims.
> â€” Harriet Woods